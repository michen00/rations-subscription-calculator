<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ration Subscription Calculator</title>
    <style>
        * {
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 600px;
            margin: 0 auto;
            padding: 2rem;
            background: #f5f5f5;
            color: #333;
        }
        h1 {
            margin-bottom: 0.5rem;
        }
        .subtitle {
            color: #666;
            margin-bottom: 2rem;
        }
        .input-group {
            background: white;
            padding: 1.5rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        label {
            display: block;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }
        .input-row {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        input[type="number"] {
            width: 120px;
            padding: 0.75rem;
            font-size: 1.1rem;
            border: 2px solid #ddd;
            border-radius: 6px;
        }
        input[type="number"]:focus {
            outline: none;
            border-color: #007bff;
        }
        .unit {
            color: #666;
        }
        .helper {
            font-size: 0.85rem;
            color: #888;
            margin-top: 0.5rem;
        }
        .results {
            background: white;
            padding: 1.5rem;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            margin-top: 1.5rem;
        }
        .results h2 {
            margin-top: 0;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid #eee;
        }
        .result-item {
            padding: 1rem 0;
            border-bottom: 1px solid #eee;
        }
        .result-item:last-child {
            border-bottom: none;
        }
        .result-label {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 0.25rem;
        }
        .result-value {
            font-size: 1.4rem;
            font-weight: 600;
            color: #007bff;
        }
        .result-value.best {
            color: #28a745;
        }
        .comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-top: 1rem;
        }
        .comparison-box {
            background: #f8f9fa;
            padding: 1rem;
            border-radius: 6px;
            text-align: center;
        }
        .comparison-box.winner {
            background: #d4edda;
            border: 2px solid #28a745;
        }
        .comparison-title {
            font-weight: 600;
            margin-bottom: 0.5rem;
        }
        .comparison-detail {
            font-size: 0.85rem;
            color: #666;
        }
        .warning {
            background: #fff3cd;
            border: 1px solid #ffc107;
            padding: 1rem;
            border-radius: 6px;
            margin-top: 1rem;
        }
        .error {
            background: #f8d7da;
            border: 1px solid #dc3545;
            padding: 1rem;
            border-radius: 6px;
            margin-top: 1rem;
        }
    </style>
</head>
<body>
    <h1>üì¶ Ration Subscription Calculator</h1>
    <p class="subtitle">Find the optimal N pallets every M weeks (or J months)</p>

    <div class="input-group">
        <label for="budget">Budget per Order (X)</label>
        <div class="input-row">
            <span class="unit">$</span>
            <input type="number" id="budget" min="0" step="0.01" placeholder="100">
        </div>
    </div>

    <div class="input-group">
        <label for="pallet-cost">Cost per Pallet (Y)</label>
        <div class="input-row">
            <span class="unit">$</span>
            <input type="number" id="pallet-cost" min="0.01" step="0.01" placeholder="20">
        </div>
    </div>

    <div class="input-group">
        <label for="days-per-pallet">Days per Pallet</label>
        <div class="input-row">
            <input type="number" id="days-per-pallet" min="1" step="1" value="24" placeholder="24">
            <span class="unit">days</span>
        </div>
    </div>

    <div id="results" class="results" style="display: none;">
        <h2>üìä Results</h2>
        <div id="results-content"></div>
    </div>

    <script>
        const DAYS_PER_WEEK = 7;
        const DAYS_PER_MONTH = 30.44;
        const MIN_WEEKS = 1;
        const MAX_WEEKS = 16;
        const VALID_MONTHS = [5, 6, 7, 8];

        const budgetInput = document.getElementById('budget');
        const palletCostInput = document.getElementById('pallet-cost');
        const daysPerPalletInput = document.getElementById('days-per-pallet');
        const resultsDiv = document.getElementById('results');
        const resultsContent = document.getElementById('results-content');

        function calculate() {
            const budget = parseFloat(budgetInput.value);
            const palletCost = parseFloat(palletCostInput.value);
            const daysPerPallet = parseInt(daysPerPalletInput.value) || 24;

            if (!budget || !palletCost || budget <= 0 || palletCost <= 0 || daysPerPallet < 1) {
                resultsDiv.style.display = 'none';
                return;
            }

            resultsDiv.style.display = 'block';

            const maxPallets = Math.floor(budget / palletCost);
            
            if (maxPallets < 1) {
                resultsContent.innerHTML = `
                    <div class="error">
                        <strong>Budget too low!</strong><br>
                        You need at least $${palletCost.toFixed(2)} to order 1 pallet.
                    </div>
                `;
                return;
            }

            const daysCovered = maxPallets * daysPerPallet;
            const actualCost = maxPallets * palletCost;
            
            // Calculate best weekly option
            const maxWeeksRaw = Math.floor(daysCovered / DAYS_PER_WEEK);
            const bestWeeks = Math.min(Math.max(maxWeeksRaw, MIN_WEEKS), MAX_WEEKS);
            const weeksValid = maxWeeksRaw >= MIN_WEEKS;
            const weeksDays = bestWeeks * DAYS_PER_WEEK;
            const weeksBuffer = daysCovered - weeksDays;

            // Calculate best monthly option
            const maxMonthsRaw = Math.floor(daysCovered / DAYS_PER_MONTH);
            const validMonthOptions = VALID_MONTHS.filter(m => m <= maxMonthsRaw);
            const bestMonths = validMonthOptions.length > 0 ? Math.max(...validMonthOptions) : null;
            const monthsValid = bestMonths !== null;
            const monthsDays = monthsValid ? Math.ceil(bestMonths * DAYS_PER_MONTH) : 0;
            const monthsBuffer = monthsValid ? daysCovered - monthsDays : 0;

            // Determine winner (longer interval = fewer orders = better)
            let weeklyIntervalDays = bestWeeks * DAYS_PER_WEEK;
            let monthlyIntervalDays = monthsValid ? bestMonths * DAYS_PER_MONTH : 0;
            
            let winner = 'weekly';
            if (monthsValid && monthlyIntervalDays > weeklyIntervalDays) {
                winner = 'monthly';
            }

            let html = `
                <div class="result-item">
                    <div class="result-label">Maximum pallets per order</div>
                    <div class="result-value">${maxPallets} pallets</div>
                    <div class="helper">Covers ${daysCovered} days ¬∑ Costs $${actualCost.toFixed(2)}</div>
                </div>

                <div class="comparison">
                    <div class="comparison-box ${winner === 'weekly' ? 'winner' : ''}">
                        <div class="comparison-title">üìÖ Weekly Option</div>
                        ${weeksValid ? `
                            <div class="result-value ${winner === 'weekly' ? 'best' : ''}">${maxPallets} pallets / ${bestWeeks} weeks</div>
                            <div class="comparison-detail">
                                ${weeksDays} days between orders<br>
                                ${weeksBuffer} days buffer
                            </div>
                        ` : `
                            <div class="comparison-detail">Not enough for even 1 week</div>
                        `}
                    </div>
                    <div class="comparison-box ${winner === 'monthly' ? 'winner' : ''}">
                        <div class="comparison-title">üóìÔ∏è Monthly Option</div>
                        ${monthsValid ? `
                            <div class="result-value ${winner === 'monthly' ? 'best' : ''}">${maxPallets} pallets / ${bestMonths} months</div>
                            <div class="comparison-detail">
                                ~${monthsDays} days between orders<br>
                                ~${Math.floor(monthsBuffer)} days buffer
                            </div>
                        ` : `
                            <div class="comparison-detail">Need ${Math.ceil(5 * DAYS_PER_MONTH)} days for 5-month minimum</div>
                        `}
                    </div>
                </div>
            `;

            if (weeksValid && bestWeeks < maxWeeksRaw) {
                html += `
                    <div class="warning">
                        ‚ö†Ô∏è Your rations could cover ${maxWeeksRaw} weeks, but the max allowed is 16 weeks.
                    </div>
                `;
            }

            resultsContent.innerHTML = html;
        }

        budgetInput.addEventListener('input', calculate);
        palletCostInput.addEventListener('input', calculate);
        daysPerPalletInput.addEventListener('input', calculate);
    </script>
</body>
</html>
